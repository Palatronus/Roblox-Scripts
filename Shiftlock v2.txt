local uis = game:GetService("UserInputService")
local e = Enum

-- Mouse behavior enums
local enumMLCP = e.MouseBehavior.LockCurrentPosition
local enumMLC = (uis.TouchEnabled and enumMLCP) or e.MouseBehavior.LockCenter
local enumMD = e.MouseBehavior.Default

-- Shiftlock state
local shiftlock = false
local lastMouseBehavior = uis.MouseBehavior

-- Mouse behavior enforcement
uis:GetPropertyChangedSignal("MouseBehavior"):Connect(function()
    if shiftlock and uis.MouseBehavior ~= lastMouseBehavior then
        uis.MouseBehavior = lastMouseBehavior
    end
end)

-- Shift key toggle
uis.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.LeftShift then
        shiftlock = not shiftlock
        lastMouseBehavior = shiftlock and enumMLC or enumMD
        uis.MouseBehavior = lastMouseBehavior
    end
end)

-- Touch device adaptation
if uis.TouchEnabled then
    uis.TouchTap:Connect(function(touchPos)
        if shiftlock then
            uis.MouseBehavior = enumMLCP
        end
    end)
end

print("Shiftlock system loaded - Press Left Shift to toggle")
