#NoEnv
SendMode Input
SetTitleMatchMode, 2
CoordMode, Mouse, Screen

; === CONFIGURATION ===
targetWindow := "ahk_exe RobloxPlayerBeta.exe"  ; Roblox window identifier
toggleKey := "F1"                               ; ShiftLock toggle key
sensitivity := 0.6                              ; Lower = slower rotation
centerX := A_ScreenWidth // 2                   ; Screen center X
centerY := A_ScreenHeight // 2                  ; Screen center Y
; =====================

isShiftLockActive := false
originalMouseSpeed := A_MouseSpeed

; === MAIN TOGGLE ===
Hotkey, %toggleKey%, ToggleShiftLock
return

ToggleShiftLock:
    if (!WinActive(targetWindow)) {
        return
    }
    
    isShiftLockActive := !isShiftLockActive
    
    if (isShiftLockActive) {
        ; Enter ShiftLock mode
        BlockInput, MouseMove
        MouseGetPos, originalX, originalY
        DllCall("SetCursorPos", "int", centerX, "int", centerY)
        Send {RButton down}
        SetDefaultMouseSpeed, 0
        MouseMove, centerX, centerY, 0
        SoundBeep, 1000, 100
    } else {
        ; Exit ShiftLock mode
        BlockInput, MouseMoveOff
        Send {RButton up}
        DllCall("SetCursorPos", "int", originalX, "int", originalY)
        SoundBeep, 500, 100
    }
return

; === INPUT HANDLING ===
#IfWinActive %targetWindow%
~LButton::return  ; Disable accidental clicks

~MouseMove:
    if (isShiftLockActive) {
        MouseGetPos, currX, currY
        deltaX := (currX - centerX) * sensitivity
        deltaY := (currY - centerY) * sensitivity * 0.3  ; Reduce vertical sensitivity
        
        ; Send adjusted input
        DllCall("mouse_event", "UInt", 0x0001, "Int", deltaX, "Int", deltaY)
        DllCall("SetCursorPos", "int", centerX, "int", centerY)
    }
return
