-- LDPlayer-Compatible Auto-Clicker
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Configuration
local TOGGLE_KEY = Enum.KeyCode.Q
local CPS = 20
local CLICK_INTERVAL = 1/CPS

-- State tracking
local enabled = false
local mouseDown = false

-- Notification function
local function Notify(message)
    pcall(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "AUTO-CLICKER",
            Text = message,
            Duration = 2,
            Icon = "rbxassetid://6726578095"
        })
    end)
    print("AutoClicker: "..message)
end

-- Mouse state manipulation
local function SetMouseState(down)
    if down then
        -- Press mouse button
        mouseDown = true
        game:GetService("ContextActionService"):CallFunction("CoreGuiMouseCapture", "MouseButton1Down", Vector2.new())
    else
        -- Release mouse button
        mouseDown = false
        game:GetService("ContextActionService"):CallFunction("CoreGuiMouseCapture", "MouseButton1Up", Vector2.new())
    end
end

-- Toggle functionality
local function ToggleAutoClicker()
    enabled = not enabled
    
    if enabled then
        Notify("ENABLED (20 CPS)")
        -- Start click loop
        coroutine.wrap(function()
            while enabled and task.wait(CLICK_INTERVAL) do
                -- Create click by quickly pressing and releasing
                SetMouseState(true)
                task.wait(0.01)
                SetMouseState(false)
            end
        end)()
    else
        Notify("DISABLED")
        -- Ensure mouse is released when disabled
        if mouseDown then
            SetMouseState(false)
        end
    end
end

-- Key bind setup
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == TOGGLE_KEY and not UserInputService:GetFocusedTextBox() then
        ToggleAutoClicker()
    end
end)

-- Initialization
Notify("Ready - Press Q to toggle")
print("AutoClicker initialized for LDPlayer")
print("CPS: "..CPS.." | Interval: "..CLICK_INTERVAL.."s")
