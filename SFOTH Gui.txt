local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LP = Players.LocalPlayer
local Toggle = false
local Debounce = false

-- Toggle with H key
UIS.InputBegan:Connect(function(Input)
    if Input.KeyCode == Enum.KeyCode.H then
        Toggle = not Toggle
        LP.PlayerGui:SetTopbarTransparency(Toggle and 0 or 1)
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Auto Armor/Heal",
            Text = Toggle and "Enabled" or "Disabled",
            Duration = 1
        })
    end
end)

local function CollectItem(Name)
    if Debounce or not Toggle then return end
    Debounce = true
    
    local Item = workspace:FindFirstChild(Name)
    if Item and LP.Character and LP.Character:FindFirstChild("HumanoidRootPart") then
        local OriginalCF = LP.Character.HumanoidRootPart.CFrame
        local OriginalPos = OriginalCF.Position
        
        -- Teleport to item
        LP.Character.HumanoidRootPart.CFrame = Item.CFrame + Vector3.new(0,3,0)
        
        -- Wait for item collection
        RunService.RenderStepped:Wait()
        task.wait(0.15)
        
        -- Return to original position
        LP.Character.HumanoidRootPart.CFrame = OriginalCF
        
        -- Delete item locally
        if Item.Parent == workspace then
            Item:Destroy()
        end
    end
    Debounce = false
end

-- Auto armor on respawn
LP.CharacterAdded:Connect(function(Char)
    if Toggle then
        repeat task.wait() until Char:FindFirstChild("HumanoidRootPart")
        CollectItem("BattleArmor")
    end
end)

-- Auto heal when damaged
LP.CharacterAdded:Connect(function(Char)
    local Hum = Char:WaitForChild("Humanoid")
    Hum.HealthChanged:Connect(function()
        if Toggle and Hum.Health < Hum.MaxHealth then
            CollectItem("Pad")
        end
    end)
end)

-- Initial execution
if LP.Character then
    CollectItem("BattleArmor")
end

game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Auto Armor/Heal Loaded",
    Text = "Press H to toggle",
    Duration = 5
})
