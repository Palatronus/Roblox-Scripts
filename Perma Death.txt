-- FE Reanimation Script (LocalScript)
local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local root = character:WaitForChild("HumanoidRootPart")

-- Kill initial character
humanoid.Health = 0

player.CharacterAdded:Connect(function(newChar)
    -- Hide new character
    local newHum = newChar:WaitForChild("Humanoid")
    newChar:WaitForChild("HumanoidRootPart")
    
    for _, v in pairs(newChar:GetDescendants()) do
        if v:IsA("BasePart") then
            v.Transparency = 1
            v.CanCollide = false
        end
    end
    
    -- Reanimate old corpse
    local fakeChar = character:Clone()
    fakeChar.Parent = workspace
    fakeChar:MoveTo(root.Position)
    
    local fakeHum = fakeChar:FindFirstChild("Humanoid")
    if fakeHum then fakeHum:Destroy() end
    
    -- Network ownership transfer
    for _, v in pairs(fakeChar:GetDescendants()) do
        if v:IsA("BasePart") then
            v:SetNetworkOwner(player)
            v.CanCollide = true
            v.Anchored = false
        end
    end
    
    -- Fling mechanism
    local flingForce = 5000
    local function fling(targetRoot)
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.Velocity = (targetRoot.Position - fakeChar.HumanoidRootPart.Position).Unit * flingForce
        bodyVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        bodyVelocity.Parent = targetRoot
        game:GetService("Debris"):AddItem(bodyVelocity, 0.1)
    end
    
    -- Click detection
    local mouse = player:GetMouse()
    mouse.Button1Down:Connect(function()
        local target = mouse.Target
        if target and target.Parent:FindFirstChild("HumanoidRootPart") then
            fling(target.Parent.HumanoidRootPart)
        end
    end)
    
    -- Movement control
    while true do
        game:GetService("RunService").Heartbeat:Wait()
        if newChar.PrimaryPart and fakeChar.PrimaryPart then
            fakeChar:SetPrimaryPartCFrame(newChar.PrimaryPart.CFrame)
        end
    end
end)
