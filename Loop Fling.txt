local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local UIS = game:GetService("UserInputService")

-- GUI Setup
local GUI = Instance.new("ScreenGui")
GUI.Parent = game.CoreGui

local Main = Instance.new("Frame")
Main.Size = UDim2.new(0, 300, 0, 180)
Main.Position = UDim2.new(0.5, -150, 0.5, -90)
Main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Main.Parent = GUI

-- Input Field
local Input = Instance.new("TextBox")
Input.PlaceholderText = "Username"
Input.Size = UDim2.new(0.9, 0, 0.2, 0)
Input.Position = UDim2.new(0.05, 0, 0.1, 0)
Input.Parent = Main

-- Control Buttons
local Toggle = Instance.new("TextButton")
Toggle.Text = "FLING TOGGLE"
Toggle.Size = UDim2.new(0.6, 0, 0.2, 0)
Toggle.Position = UDim2.new(0.2, 0, 0.4, 0)
Toggle.Parent = Main

local CamButton = Instance.new("TextButton")
CamButton.Text = "CAMERA TOGGLE"
CamButton.Size = UDim2.new(0.6, 0, 0.2, 0)
CamButton.Position = UDim2.new(0.2, 0, 0.65, 0)
CamButton.Parent = Main

-- Core Fling System
local Flinging = false
local function FlingTarget(target)
    while Flinging and task.wait() do
        if target.Character and LP.Character then
            local tHRP = target.Character:FindFirstChild("HumanoidRootPart")
            local myHRP = LP.Character:FindFirstChild("HumanoidRootPart")
            
            if tHRP and myHRP then
                -- Force network control
                tHRP:SetNetworkOwner(LP)
                
                -- Aggressive position/velocity pattern
                myHRP.CFrame = tHRP.CFrame * CFrame.new(0, 2, 0)
                myHRP.Velocity = Vector3.new(
                    math.random(-2500, 2500),
                    5000,
                    math.random(-2500, 2500)
                )
            end
        end
    end
end

-- Camera System
local Tracking = false
local function TrackTarget(target)
    while Tracking and task.wait() do
        if target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            Camera.CameraType = Enum.CameraType.Scriptable
            Camera.CFrame = CFrame.new(
                target.Character.HumanoidRootPart.Position + Vector3.new(0, 5, 10),
                target.Character.HumanoidRootPart.Position
            )
        end
    end
    Camera.CameraType = Enum.CameraType.Custom
end

-- Button Handlers
Toggle.MouseButton1Click:Connect(function()
    Flinging = not Flinging
    if Flinging then
        local target = Players:FindFirstChild(Input.Text)
        if target then
            coroutine.wrap(FlingTarget)(target)
        end
    end
end)

CamButton.MouseButton1Click:Connect(function()
    Tracking = not Tracking
    if Tracking then
        local target = Players:FindFirstChild(Input.Text)
        if target then
            coroutine.wrap(TrackTarget)(target)
        end
    else
        Camera.CameraType = Enum.CameraType.Custom
    end
end)

-- Dragging System
local dragging, dragInput, dragStart
Main.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
    end
end)

Main.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UIS.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        Main.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)
