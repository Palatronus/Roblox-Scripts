-- Replace the ENTIRE "Fling System" section with this optimized code:

-- Fling System
local flingActive = false
local targetPlayer = nil
local TARGET_USERNAME = ""
local FLING_POWER = 100000 -- Extreme force
local connection = nil

-- Noclip (critical for movement)
local function enableNoclip()
    if lp.Character then
        for _, part in pairs(lp.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
                part.Massless = true
            end
        end
    end
end

-- Target validation
local function validateTarget()
    targetPlayer = getPlayer(TARGET_USERNAME)
    return targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart")
end

-- Efficient fling logic
local function applyFling()
    local targetRoot = targetPlayer.Character.HumanoidRootPart
    local localRoot = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")
    if not localRoot then return end

    -- Teleport to target instantly
    localRoot.CFrame = targetRoot.CFrame * CFrame.new(0, 0, -3) -- Position behind target

    -- Apply explosive force to target
    local direction = (targetRoot.Position - localRoot.Position).Unit
    targetRoot.Velocity = direction * FLING_POWER + Vector3.new(
        math.random(-1000, 1000),
        math.random(500, 1500),
        math.random(-1000, 1000)
    )
end

-- Heartbeat handler (low CPU usage)
local function maintainFling()
    while flingActive and task.wait(0.18) do -- Reduced frequency
        pcall(function()
            if validateTarget() then
                applyFling()
            end
        end)
    end
end

-- Toggle system
toggleBtn.MouseButton1Click:Connect(function()
    flingActive = not flingActive
    toggleBtn.Text = flingActive and "STOP FLING" or "START FLING"

    if flingActive then
        TARGET_USERNAME = inputBox.Text
        enableNoclip()
        if connection then connection:Disconnect() end
        connection = RunService.Heartbeat:Connect(maintainFling)
    else
        TARGET_USERNAME = ""
        targetPlayer = nil
        if connection then
            connection:Disconnect()
            connection = nil
        end
    end
end)
