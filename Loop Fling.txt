local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")
local LP = Players.LocalPlayer
local Mouse = LP:GetMouse()

-- GUI Creation
local GUI = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextBox = Instance.new("TextBox")
local Toggle = Instance.new("TextButton")
local Status = Instance.new("TextLabel")

GUI.Name = "FlingGUI"
GUI.Parent = game.CoreGui

Frame.Size = UDim2.new(0, 200, 0, 120)
Frame.Position = UDim2.new(0.5, -100, 0.5, -60)
Frame.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
Frame.Parent = GUI

TextBox.Size = UDim2.new(0.8, 0, 0.2, 0)
TextBox.Position = UDim2.new(0.1, 0, 0.1, 0)
TextBox.PlaceholderText = "Enter username"
TextBox.Parent = Frame

Toggle.Size = UDim2.new(0.6, 0, 0.3, 0)
Toggle.Position = UDim2.new(0.2, 0, 0.4, 0)
Toggle.Text = "Toggle Fling"
Toggle.Parent = Frame

Status.Size = UDim2.new(0.8, 0, 0.2, 0)
Status.Position = UDim2.new(0.1, 0, 0.75, 0)
Status.Text = "Status: Idle"
Status.Parent = Frame

-- Fling Mechanism
local Flinging = false
local Target
local OffsetPattern = {
    Vector3.new(5,10,5),
    Vector3.new(-5,10,-5),
    Vector3.new(10,5,-10),
    Vector3.new(-10,5,10)
}

local function GetTarget()
    local username = TextBox.Text
    for _, p in pairs(Players:GetPlayers()) do
        if p.Name:lower() == username:lower() then
            return p
        end
    end
    return nil
end

local function PredictionFling()
    if not Target or not Target.Character then return end
    local HRP = Target.Character:FindFirstChild("HumanoidRootPart")
    local MyHRP = LP.Character and LP.Character:FindFirstChild("HumanoidRootPart")
    
    if HRP and MyHRP then
        local CurrentIndex = 0
        local CycleSpeed = 0.01 -- Lower = faster cycle
        
        for i = 1, #OffsetPattern do
            if not Flinging then break end
            local offset = OffsetPattern[i] * 3
            local targetPos = HRP.Position + offset
            
            -- Apply instant velocity
            MyHRP.Velocity = Vector3.new(0,0,0)
            MyHRP.CFrame = CFrame.new(targetPos)
            
            -- Add extra force vectors
            MyHRP.Velocity = (HRP.Position - MyHRP.Position).Unit * 5000 + Vector3.new(0,10000,0)
            MyHRP.RotVelocity = Vector3.new(math.random(-50,50), math.random(-50,50), math.random(-50,50))
            
            wait(CycleSpeed)
        end
    end
end

-- Toggle Handler
Toggle.MouseButton1Click:Connect(function()
    Flinging = not Flinging
    
    if Flinging then
        Target = GetTarget()
        if not Target then
            Flinging = false
            Status.Text = "Status: Invalid target"
            return
        end
        
        Status.Text = "Status: Flinging "..Target.Name
        LP.CharacterAdded:Connect(function()
            if Flinging then
                wait(1)
                PredictionFling()
            end
        end)
        
        spawn(function()
            while Flinging do
                PredictionFling()
                RS.Heartbeat:Wait()
            end
        end)
    else
        Status.Text = "Status: Idle"
        if LP.Character and LP.Character:FindFirstChild("HumanoidRootPart") then
            LP.Character.HumanoidRootPart.Velocity = Vector3.new(0,0,0)
        end
    end
end)

-- Auto-reconnect handler
Players.PlayerAdded:Connect(function(plr)
    if Flinging and plr.Name:lower() == TextBox.Text:lower() then
        Target = plr
    end
end)